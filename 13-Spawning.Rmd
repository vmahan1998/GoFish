# Spawning Behavior

## Overview

This submodel simulates the conditions, triggers, and behavioral outcomes associated with spawning in anadromous fish. It integrates physiological thresholds, habitat preferences, reproductive strategies, and energy-based constraints to identify spawning events and their consequences during migration.

## Purpose and Patterns

This submodel captures ecologically grounded reproductive strategies in anadromous fishes by simulating individual-based spawning behavior as a function of habitat, physiological readiness, and reproductive strategy.

-   Spawning is initiated when agents meet combined salinity and thermal stress thresholds and have sufficient energy reserves, reflecting empirically observed constraints on reproductive viability in migratory fishes.

-   Broadcast spawners initiate spawning in freshwater patches with suitable depth and flow conditions, consistent with the behavior of species like alewife and rainbow smelt. Fertilization success is probabilistically scaled by the local density of mature males, reflecting external gamete mixing dynamics in flowing water.

-   Pairwise spawners, such as sturgeon and striped bass, require physical co-location of a reproductively ready male and female in suitable habitat. This reflects species that engage in close-contact courtship and synchronize gamete release based on microhabitat cues.

-   Spawning events result in an immediate energy cost and update internal states for both male and female agents. Iteroparous species may spawn more than once if conditions remain favorable, while semelparous species are subject to mortality following reproductive exhaustion.

-   Energetic depletion after spawning triggers resting or staging behavior before resuming seaward migration. Overwintering probability is dynamically calculated based on energy levels, spawning timing, age, and size, reflecting seasonal decisions observed in species like Atlantic salmon and shortnose sturgeon.

-   Spatial overlap of spawning-ready agents in high-quality patches allows emergent identification of reproductive hotspots and helps model the intersection of life history traits and estuarine hydrodynamics.

## Entities, State Variables, and Scales

### Spatial and Temporal Scales

-   **Spatial Unit**: Patch (3 m x 3 m resolution)
-   **Temporal Unit**: 5-minute time steps (`tick`)

### Patch Variables

| Variable Name | Definition |
|------------------------------------|------------------------------------|
| Salinity $S_{patch}$ | anadromous fish are known to typically spawn in freshwater reaches of the estuary |
| Temperature $T_{patch}$ | Patch-level temperature from hydrodynamic model |
| Depth $d_{patch}$ | Patch-level water column depth |
| Velocity $V_{patch}$ | Patch-level water velocity |
| spawning-in-patch | Boolean flag indicating active spawning event |

### Agent Variables

| Variable Name | Definition |
|-------------------------------------|-------------------------------------|
| size $M_{agent}$ | Individual fish body size |
| age $A_{agent}$ | Individual fish age |
| sex $s_{agent}$ | Sex of agent |
| energy $E_{agent}$ | Current metabolic energy level |
| spawning energy $E_{spawn}$ | Energy cost to spawn |
| spawning encounters $spawn_{encounters}$ | Count of fertilization events related to agent's spawn |
| spawns $spawn_{n}$ | Number of individual spawning encounters |
| spawning limit $lim_{spawn}$ | Maximum spawns allowed for individual |
| spawning strategy | Reproductive mode (broadcast or pairwise) |
| Salinity Stress $S_{stress}$ | Osmotic stress response |
| Thermal Stress $T_{stress}$ | Deviation from thermal optima |
| spawning depth $d_{spawn}$ | Known depth limit for spawning |
| STST? | Boolean for if agent is using Selective Tidal Stream Transport |

## Process Overview and Scheduling

1.  **Spawning Readiness**\
    Each agent evaluates whether it is spawning-ready based on salinity stress, thermal stress, energy levels, and whether it has exceeded its spawning limit. If all conditions are met, the agent is considered ready to spawn.

2.  **Spawning Strategy**\
    For broadcast spawners, the female initiates spawning if the patch meets the suitability criteria. Fertilization probability is calculated based on the number of males within the local radius. For pairwise spawners, spawning occurs only if one male and one female are both in the same patch, both are spawning-ready, and habitat conditions meet the required criteria.

3.  **Spawning Energy**\
    After spawning, the agent’s energy is reduced by the spawning energy cost.

4.  **Post-Spawning Behavior**\
    If the agent’s energy is sufficient, it switches to seaward migration. If energy is below the threshold, the agent enters a resting/staging state until its energy is restored.

5.  **Mortality Risk**\
    For semelparous species, the mortality risk increases after spawning, with the probability increasing based on age. For iteroparous species, the mortality risk is lower and also age-dependent.

6.  **Overwintering Probability**\
    The overwintering probability is calculated based on the agent's energy, age, size, and days since the last spawning. Overwintering is more likely for older fish, those with low energy, or those that spawned recently.

## Design Concepts

**Basic Principles:** Spawning behavior in anadromous fish is influenced by a combination of environmental conditions (salinity, temperature, depth, and velocity) and physiological readiness. Fish assess these conditions and their internal energy reserves to decide when and where to spawn.

**Emergence:** High-quality spawning patches with favorable environmental conditions emerge, and spawning encounters increase in these areas. Overlap of spawning-ready agents in these patches leads to emergent patterns of reproductive success.

**Adaptation:** Fish respond to varying environmental conditions by adjusting their spawning behavior. Broadcast spawners will select the highest probability patch based on the presence of males, while pairwise spawners rely on physical proximity for spawning. Iteroparous species may spawn multiple times in a season if conditions remain favorable, whereas semelparous species spawn once and die.

**Objectives:** The primary objective of spawning behavior is to maximize reproductive success. This is achieved by ensuring optimal environmental conditions for gamete fertilization while minimizing the energetic cost of spawning and migration.

**Prediction:** Broadcast spawners do not predict future conditions but react to local male density and environmental suitability. Pairwise spawners predict spawning success based on habitat conditions and the availability of a mate.

**Sensing:** Agents sense local patch temperature, salinity, depth, and velocity. They also assess the presence of other agents (both male and female) to determine readiness for spawning.

**Interaction:** Male and female agents interact through proximity in pairwise spawning, while broadcast spawners interact with males via fertilization probability calculations. Both strategies involve the exchange of gametes, with varying degrees of synchronization and spatial organization.

**Stochasticity:** The model includes probabilistic factors in fertilization success and mortality. For broadcast spawners, fertilization success is probabilistically scaled by the number of males, while mortality is age-dependent.

**Observation:** The model tracks spawning encounters, spawning energy expenditures, energy recovery, mortality rates, and overwintering probabilities.

## Initialization

| Variable | Initialized Value | Justification |
|------------------|------------------|------------------------------------|
| $E_{agent}$ | 100 | Assumes full energy at initialization |
| $E_{spawn}$ | species-specific | Threshold to permit spawning |
| $spawned-this-tick?$ | false | Agent has not spawned yet |
| $A_{agent}$ | population distribution | Age assigned from population parameters |
| $M_{agent}$ | size-at-age curve | Species-specific size growth |
| $spawning-strategy$ | broadcast or pairwise | Species-level trait |
| $lim_{spawn}$ | dependent on sex and species | How many times a fish is capable of spawning in a single migration |
| $d_{spawn}$ | dependent on species | Species specific known depth preference to spawn |
| $S_{stress}$ | 0 | No stress at initialization |
| $T_{stress}$ | 0 | No stress at initialization |
| $S_{overwinter}$ | 0 or 1 | Binary species trait |
| $t_{spawn}$ | 0 | Time since last spawning |
| $E_{recover}$ | 75 | Required energy to resume post-spawning migration |

## Submodels

### Spawning Readiness

Agents are considered spawning-ready if they meet the following physiological conditions:

$$
\text{SpawningReady} = \begin{cases}\text{true}, & \text{if } S_{stress} < 3 \text{ and } T_{stress} < 3 \text{ and } E_{agent} > E_{spawn} \text{ and } spawn_{n} < lim_{spawn} \text{ and } STST? = false \\\text{false}, & \text{otherwise}\end{cases}
$$

-   $S_{stress}$ = salinity stress
-   $T_{stress}$ = thermal stress
-   $E_{agent}$ = current energy level of agent
-   $E_{spawn}$ = minimum energy required for spawning (species-specific)
-   $spawn_{n}$ how many spawns agent has performed

### **Spawning Strategy**

##### If `spawning-strategy = broadcast`:

1.  When female agent is ready to spawn, they evaluate neighboring patches:
    -   $S_{\text{patch}} \leq 0.5$
    -   $d_{\text{patch}} \leq d_{\text{spawn}}$

If no suitable patch is found, the female moves to the next patch and repeats the evaluation process until a suitable patch is identified.

Alternatively, if the female encounters a male in the same patch, the fertilization probability is considered high (near 1), and the female spawns immediately without evaluating neighboring patches.

2.  Spawning-ready males actively search for the closest spawning area, where a female has released her eggs. This search is based on both visual cues (proximity) and pheromone-based cues (chemical signals from the female). Ferilization only occurs if a male can find and fertilize the spawn within $t_{limit}$.

Spawning encounters are recorded as:

$$
spawn_{n} = spawn_{n} + 1
$$

$$
Spawn_{encounters} = \sum n_{males}
$$

Where:

-   $spawn_{encounters}$ is the number of spawning encounters

-   $n_{males}$ is the number of males fertilizing the spawn.

-   $N_{f}$ is the number of spawning-ready females in suitable patches.

##### If `spawning-strategy = pairwise`:

1.   Once a female is spawning-ready, she locates the best spawning habitat:

    -   $S_{\text{patch}} \leq 0.5$
    -   $d_{\text{patch}} \leq d_{\text{spawn}}$

2.  Spawning-ready males actively search for the closest spawning-ready female. This search is based on both visual cues (proximity) and pheromone-based cues (chemical signals from the female). Spawning only occurs if all of the following conditions are met:

    -   One male and one female are in the same patch

    -   Both are `spawning-ready`

Then, the total number of spawning events in the patch is:

$$ Spawn_{encounters} = \min(N_{\text{males}}, N_{\text{females}}) $$

$$ spawn_{n} = spawn_{encounters} $$

-   $spawn_{encounters}$ is the number of spawning encounters.

-   $spawn_{n}$ is the number of times an agent has spawned.

-   $N_{\text{males}}$ be the number of spawning-ready males in the patch.

-    $N_{\text{females}}$ be the number of spawning-ready females in the patch.

### Spawning energy

$$
E_{agent} = E_{agent}-E_{spawn}
$$

Where:

-   $E_{agent}$ is the energy levels of the agent.

-   $E_{spawn}$ is the energy cost to spawn.

### Post-Spawning Behavior

$$
\text{if } E_{\text{agent}} \geq E_{\text{recover}}, \quad \text{then } \texttt{landward_migration?} = \texttt{false}, \quad \texttt{seaward_migration?} = \texttt{true}, \quad \texttt{spawned-this-tick?} = \texttt{true}
$$

Where:

-   $E_{agent}$ is the energy levels of the agent.

-   $E_{recover}$ energy threshold to resume migration.

#### **Mortality Risk**

$$
\text{if } \text{random}(0,1) < P_{\text{mortality}}, \quad \text{then die}
$$

$$
P_{\text{mortality}} = \begin{cases}0.9 + 0.1 \cdot \frac{A_{\text{agent}}}{A_{\text{max}}}, & \text{if semelparous} \\0.01 + 0.05 \cdot \frac{A_{\text{agent}}}{A_{\text{max}}}, & \text{if iteroparous}\end{cases}
$$

Where:

-   $A_{\text{agent}}$ is the agent’s current age.

-   $A_{\text{max}}$ is the maximum lifespan for the species.

`semelparous` are species that spawn once and die.

`iteroparous` are species that can spawn multiple times.

#### **Resting Period**

Agents with low energy enter a temporary staging state until recover:

$$
\text{if } E_{\text{agent}} < E_{\text{recover}}, \quad \texttt{staging?} = \texttt{true}
$$

Where:

-   $E_{recover}$ energy threshold to resume migration (e.g., 75).

-   $E_{agent}$ is the current energy level of the agents.

#### Overwintering Probability

$$
P_{\text{overwinter}} = S_{\text{overwinter}} \cdot \left[  \alpha \cdot \left(1 - \frac{E_{\text{agent}}}{100} \right) +  \beta \cdot \left( \frac{A_{\text{agent}}}{A_{\text{max}}} \right) +  \gamma \cdot \left( \frac{M_{\text{agent}}}{M_{\text{max}}} \right) +  \delta \cdot \left( \frac{t_{\text{spawn}}}{t_{\text{max}}} \right)\right]
$$

Where:

-   $P_{\text{overwinter}}$ is the agent’s probability of overwintering.
-   $S_{\text{overwinter}}$ is the species-level binary (1 = overwinter-capable, 0 = not).
-   $E_{\text{agent}}$ is the agent's energy level (0–100%)..
-   $A_{\text{agent}}$ is the agent age.
-   $A_{\text{max}}$ is the species-specific maximum age.
-   $M_{\text{agent}}$ is the agent body size.
-   $M_{\text{max}}$ is the maximum body size in population.
-   $t_{\text{spawn}}$ are the days since last spawn.
-   $t_{\text{max}}$ is the max time allowed for overwinter decision (e.g., 60 days).
-   $\alpha, \beta, \gamma, \delta$ is the tune-able weights (e.g., 0.25 each).

**Interpretation**:

-   Lower energy → more likely to overwinter

-   Older or larger fish → more likely to overwinter

-   Fish that spawned recently → higher likelihood (if within seasonal window)

-   Species must be capable of overwintering for this to activate

**\
**
