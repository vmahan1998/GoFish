## Overview

Lipid catabolism provides a secondary energy pathway that fish use when immediate food resources are unavailable or when energy falls below a functional threshold. In this submodel, agents metabolize stored lipid reserves to restore energy, maintain migration, and avoid starvation. Lipid use is influenced by body condition, metabolic efficiency, and the magnitude of energetic deficit. Lipid depletion also reduces body weight over time, creating a biologically meaningful cost to sustained lipid reliance. Contaminant uptake does not occur during lipid catabolism, reflecting the absence of feeding.

## Purpose

The purpose of this submodel is to simulate endogenous energy mobilization through lipid reserves when fish cannot meet energetic needs through feeding. Lipid catabolism allows migratory fish to continue movement and survive temporary periods of low food availability. This mechanism reflects empirical observations of lipid use during spawning migrations, overwintering, and other energetically demanding life history periods.

This submodel is best used in tandpm with an energy recovery stratedge like filter feelding and digestion, or pref=dation and digesiton

## Entities, State Variables, and Scales

### Spatial and Temporal Scales

**Spatial Unit:** Patch (3 m x 3 m resolution)\
**Temporal Unit:** 5 minute time steps (tick)

### **Global Variables**

| Global Variable | Definition |
|------------------------------------|------------------------------------|
| **full-energy-level** | Target energy level used to compute energetic deficit during lipid use (default = 100). |
| **energy-per-lipid** | Energy returned per unit lipid mass mobilized (default = 40), used to convert lipid into energy. |
| **lipid-refill-fraction** | Fraction of body mass available to mobilize as lipid during fasting (default = 0.5). |
| **lipid-max-fraction** *(optional)* | Upper bound on lipid fraction that can be lost before mortality or physiological collapse (not currently enforced but biologically relevant). |
| **debug-lipid?** *(optional)* | Toggles printing of intermediate lipid catabolism calculations for debugging. |

### Patch Variables

Lipid catabolism does not directly depend on patch level variables, since no external resources are consumed.

### Agent Variables

| Variable Name | Definition |
|------------------------------------|------------------------------------|
| **energy** | Current energy level of the agent |
| **weight** | Current body mass of the fish |
| **original-weight** | Initial body mass used to scale maximum lipid availability |
| **lipid-catabolism-efficiency** | Efficiency with which lipids are converted into usable energy. This value is equal to the current metabolic rate divided by the metabolic rate at optimal temperature, allowing lipid use to scale with physiological performance |
| **lipid-used** | Amount of lipid converted to energy during the current step |
| **metabolism-rate** | Current metabolic rate, which influences efficiency scaling |
| baseline-metabolism-rate | Metabolic rate at optimal temperature |
| **mehg-foraging** | Methylmercury acquired during feeding (set to zero when lipids are used) |
| **hg-foraging** | Inorganic mercury acquired during feeding (set to zero when lipids are used) |
| **mehg-foraging-total** | Total methylmercury obtained from foraging |
| **hg-foraging-total** | Total inorganic mercury obtained from foraging |
| **mehg-total** | Total methylmercury accumulated |
| **hg-total** | Total inorganic mercury accumulated |

## Process Overview and Scheduling

1.  Compute energy deficit relative to a target energy level of one hundred.\
2.  Determine the lipid amount needed to fill the deficit.\
3.  Limit lipid use by the maximum lipid available for mobilization.\
4.  Apply lipid catabolism efficiency to determine usable lipid energy.\
5.  Convert mobilized lipid to energy.\
6.  Reduce weight by the amount of lipid burned.\
7.  Set contaminant uptake to zero during this process, since no feeding occurs.

## Design Concepts

**Basic Principles**\
Lipid catabolism models endogenous energy mobilization in the absence of food. Fish draw upon lipid stores when energy is low, which is a well documented physiological process during migration, overwintering, and fasting.

**Emergence**\
Patterns of weight loss, energy cycling, and recovery emerge from repeated lipid use during periods of limited food access.

**Adaptation**\
Agents adaptively mobilize lipids based on the severity of their energy deficit and on efficiency scaling from the metabolism submodel.

**Objectives**\
Agents seek to maintain enough energy to migrate, forage, avoid predation, and prevent starvation.

**Sensing**\
Agents sense their own internal energy level and lipid reserve availability.

**Interaction**\
Lipid catabolism does not require environmental interaction and therefore represents a purely endogenous process.

**Stochasticity**\
This submodel is deterministic. However, variation in weight, metabolism, and previous feeding creates emergent differences among individuals.

**Observation**\
Outputs include energy restored through lipid catabolism, lipid used, and body mass loss over time.

## Initialization

| Variable | Initialized Value | Justification |
|------------------------|------------------------|------------------------|
| weight | species specific | Establishes initial body condition |
| original-weight | equal to initial weight | Defines total lipid availability |
| energy | 100 | Full energy at initialization |
| lipid-catabolism-efficiency | from metabolism submodel | Reflects physiological scaling of lipid use |
| lipid-used | 0 | No lipid used at start |

## Submodels

### Lipid Mobilization

Maximum lipid available for mobilization depends on relative body mass:

$$
Lipid_{refill} = 0.5 \times \left(\frac{weight}{original\_weight}\right)
$$

Energy deficit relative to full energy:

$$
Energy_{deficit} = 100 - Energy
$$

Lipid required to refill the deficit:

$$
Lipid_{needed} = \frac{Energy_{deficit}}{40}
$$

Actual lipid mobilized:

$$
Lipid_{used} = \min(Lipid_{needed},\ Lipid_{refill}) \times lipid\_{catabolism\_efficiency}
$$

### Energy Conversion

Mobilized lipid is converted into energy:

$$
Energy_{added} = Lipid_{used} \times 40
$$

Energy is capped at one hundred:

$$
Energy = \min(100,\ Energy + Energy_{added})
$$

### Weight Loss

Weight decreases proportionally to lipid used:

$$
Weight = Weight - Lipid_{used}
$$

### Contaminant Bookkeeping

No mercury or methylmercury is acquired during lipid catabolism:

$$
MeHg_{digested} = 0
$$

$$
Hg_{digested} = 0
$$

These values are added to cumulative totals to maintain bookkeeping consistency, but do not increase contaminant burden.

## Netlogo Implementation

```{netlogo}

;; ===================================================================
;;  LIPID CATABOLISM SUBMODEL DECLARATIONS
;; ===================================================================

turtles-own [

  ;; Energetics & body condition
  energy
  weight
  original-weight

  ;; Lipid metabolism
  lipid-catabolism-efficiency
  lipid-used

  ;; Metabolic rate inputs
  metabolism-rate
  baseline-metabolism-rate

  ;; Contaminant bookkeeping during fasting
  mehg-foraging
  hg-foraging
  
  mehg-foraging-total
  hg-foraging-total
  
  mehg-total
  hg-total
]

;; ===================================================================
;;  LIPID CATABOLISM SUBMODEL 
;; ===================================================================

 to lipid-loss
   ;; Maximum lipid metabolized this step, adjusted by efficiency
  let lipid-refill 0.5 * (weight / original-weight)
  ;print (word "lipid-refill: " lipid-refill)
  ;print (word "current energy: " energy)
  ;; Calculate deficit and lipid need
  let energy-deficit (100 - energy)
  ;print (word "energy-deficit: " energy-deficit)
  let lipid-needed (energy-deficit / 40)
  ;print (word "lipid-needed: " lipid-needed)
  
  ;; Actual lipid use depends on efficiency and availability
  let lipid-used (min list lipid-needed lipid-refill)
  set lipid-used (lipid-used * lipid-catabolism-efficiency)
  ;print (word "lipid-used: " lipid-used)
  
  ;; Convert lipid to energy (scaled by efficiency)
  let energy-change (lipid-used * 40)
  ;print (word "energy added: " energy-change)
  set energy (energy + energy-change)
  ;print (word "energy after lipid conversion: " energy)
  if energy > 100 [ 
    set energy 100 
    print "energy capped at 100"
  ]
  
  ;; Weight loss proportional to lipid burned
  set weight weight - (lipid-used)
  ;print (word "weight after lipid loss: " weight)
  
  ;; When relying on lipids, Hg mercury foraging risk stops
    
  ;; contaminant bookkeeping
  let digested-MeHg 0
  let digested-Hg 0
  set mehg-foraging digested-MeHg
  set hg-foraging digested-Hg

  set mehg-foraging-total mehg-foraging-total + digested-MeHg
  set hg-foraging-total hg-foraging-total + digested-Hg
  set mehg-total mehg-total + digested-MeHg
  set hg-total hg-total + digested-Hg
 end
 
```
